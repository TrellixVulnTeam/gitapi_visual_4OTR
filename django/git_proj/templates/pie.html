<!doctype html>
<html>

<head>
	<title>D3 tutorial</title>
	<script src="http://d3js.org/d3.v3.min.js"></script>
</head>

<body>

	<script>
		
		var coms = {"data": [{"name": "nikolas", "commits": 1}, {"name": "Mike Bostock", "commits": 2779}, {"name": "denisname", "commits": 1}, {"name": "zan", "commits": 1}, {"name": "alexmacy", "commits": 3}, {"name": "Curran Kelleher", "commits": 4}, {"name": "Elena Glassman", "commits": 1}, {"name": "Micah Stubbs", "commits": 1}, {"name": "David Ollerhead", "commits": 1}, {"name": "Peter Lenahan", "commits": 1}, {"name": "Mike van Rossum", "commits": 2}, {"name": "F\u00e1bio Silva", "commits": 1}, {"name": "Jeferson Koslowski", "commits": 1}, {"name": "Barrie Treloar", "commits": 1}, {"name": "william-pan", "commits": 1}, {"name": "Gordon Woodhull", "commits": 1}, {"name": "Dev-Lan", "commits": 1}, {"name": "mpersing", "commits": 1}, {"name": "Minwei Xu", "commits": 2}, {"name": "Lukas Appelhans", "commits": 1}, {"name": "Fernando Lores", "commits": 1}, {"name": "Stef Walter", "commits": 1}, {"name": "Sherry Zhou", "commits": 1}, {"name": "ppeterka", "commits": 1}, {"name": "Yuichi Yazaki", "commits": 1}, {"name": "leitzler", "commits": 1}, {"name": "Gilad Peleg", "commits": 1}, {"name": "Chris Rebert", "commits": 2}, {"name": "patriciaborges", "commits": 1}, {"name": "Jaemin Jo", "commits": 2}, {"name": "Jonathan Huang", "commits": 4}, {"name": "Jason Davies", "commits": 776}, {"name": "Nathan Vander Wilt", "commits": 11}, {"name": "William Wung", "commits": 1}, {"name": "Wil Gieseler", "commits": 2}, {"name": "Alex Simoes", "commits": 1}, {"name": "Luca Mussi", "commits": 4}, {"name": "Dan Dascalescu", "commits": 5}, {"name": "Vlad-\u0218tefan Harbuz", "commits": 1}, {"name": "Arjen van Oostrum", "commits": 2}, {"name": "Thomas Preusse", "commits": 1}, {"name": "mauromelis", "commits": 1}, {"name": "Max Goldstein", "commits": 1}, {"name": "Alon Levy", "commits": 1}, {"name": "Robert Buchholz", "commits": 1}, {"name": "Dorota", "commits": 2}, {"name": "Phil Elson", "commits": 2}, {"name": "John Firebaugh", "commits": 4}, {"name": "Dave Landry", "commits": 2}, {"name": "Yves Le Maout", "commits": 1}, {"name": "Thomas Fankhauser", "commits": 9}, {"name": "Philippe Serhal", "commits": 2}, {"name": "Martin Ha\u0308cker", "commits": 3}, {"name": "Jos\u00e9 Romeu Garc\u00eda", "commits": 1}, {"name": "Tim Branyen", "commits": 3}, {"name": "Philip J\u00e4genstedt", "commits": 1}, {"name": "afc163", "commits": 1}, {"name": "ljani", "commits": 1}, {"name": "Erin Jane", "commits": 1}, {"name": "Prajit Ramachandran", "commits": 1}, {"name": "Darrick Brown", "commits": 1}, {"name": "Timmy Willison", "commits": 2}, {"name": "Jim Kang", "commits": 1}, {"name": "Roger Bramon", "commits": 1}, {"name": "Fabricio Tavares de Oliveira", "commits": 1}, {"name": "Alexander WU", "commits": 1}, {"name": "jbblanchet", "commits": 2}, {"name": "PatrickJS", "commits": 1}, {"name": "Jesus Magana", "commits": 1}, {"name": "kmindi", "commits": 3}, {"name": "Stuart Glaser", "commits": 2}, {"name": "Daniel Goldbach", "commits": 27}, {"name": "Guy Bedford", "commits": 2}, {"name": "Harry Voorhees", "commits": 6}, {"name": "Leonardo Dutra", "commits": 8}, {"name": "adnan", "commits": 2}, {"name": "Jared Forsyth", "commits": 2}, {"name": "Erik Cunningham", "commits": 3}, {"name": "Ryan Alexander", "commits": 3}, {"name": "Freeyorp", "commits": 1}, {"name": "Carlos Rendon", "commits": 7}, {"name": "shilad", "commits": 1}, {"name": "Scott Cheng", "commits": 8}, {"name": "Chia-liang Kao", "commits": 2}, {"name": "Dan Milon", "commits": 1}, {"name": "JD Isaacks", "commits": 3}, {"name": "Dan Tillberg", "commits": 1}, {"name": "Lee Leathers", "commits": 1}, {"name": "Adam Sunderland", "commits": 3}, {"name": "Ilya Boyandin", "commits": 1}, {"name": "Dean Malmgren", "commits": 2}, {"name": "Calvin Metcalf", "commits": 1}, {"name": "Ziggy Jonsson", "commits": 2}, {"name": "Isaac Z. Schlueter", "commits": 1}, {"name": "Ger Hobbelt", "commits": 3}, {"name": "Steven Noble", "commits": 4}, {"name": "Dirk Bergstrom", "commits": 1}, {"name": "Brandon Liu", "commits": 1}, {"name": "George Adams", "commits": 1}, {"name": "Lache\u0300ze Alexandre", "commits": 1}, {"name": "webmonarch", "commits": 7}, {"name": "Kristofer Monisit", "commits": 50}, {"name": "Michael Meisel", "commits": 2}, {"name": "David Poncelow", "commits": 3}, {"name": "Jon Seymour", "commits": 2}, {"name": "Carlos Scheidegger", "commits": 1}, {"name": "Stephen Bannasch", "commits": 1}, {"name": "Michael Jackson", "commits": 1}, {"name": "Zee Agency", "commits": 1}, {"name": "Trevor Norris", "commits": 6}, {"name": "Ian Malpass", "commits": 2}, {"name": "Andrew Sutherland", "commits": 2}, {"name": "Jim Radford", "commits": 1}, {"name": "Lars Kotthoff", "commits": 11}, {"name": "Andy Chong", "commits": 1}, {"name": "Gerard Hundman", "commits": 1}, {"name": "Johan Sundstr\u00f6m", "commits": 2}, {"name": "Peter Woodman", "commits": 5}, {"name": "yasirs", "commits": 11}, {"name": "Xavier Shay", "commits": 2}, {"name": "Mitsutoshi Aoe", "commits": 5}, {"name": "Mike Bostock + Erica Kwan", "commits": 1}, {"name": "Tommy Montgomery", "commits": 1}, {"name": "Caged", "commits": 2}, {"name": "Ignacio", "commits": 1}, {"name": "Jan Alonzo", "commits": 1}, {"name": "vtstarin", "commits": 1}, {"name": "Kevin J. Lynagh", "commits": 1}, {"name": "chris viau", "commits": 2}, {"name": "Jeffrey Heer", "commits": 8}, {"name": "Square", "commits": 9}, {"name": "Nelson Minar", "commits": 7}, {"name": "Michael Bostock", "commits": 225}]}
		
		var list = coms["data"];
		
		var users = 
		[
			{"username": "conor-gil", "commits": 104},
			{"username": "dhurley", "commits": 38},
			{"username": "cianob", "commits": 186},
			{"username": "eleahy", "commits": 76},
			{"username": "conor-gil2", "commits": 204},
			{"username": "dhurley2", "commits": 138},
			{"username": "cianob2", "commits": 286},
			{"username": "eleahy2", "commits": 176}
		]
		
		var data = list.map(function (i) { return parseInt(i.commits); });
		console.log(data);
		
		
		var r = 250;
		var width = 1500;
		var height = 1500;
		
		var color = d3.scale.linear()
			.domain([0,2779])
			.range(["red","blue"]);
			
		var canvas = d3.select("body").append("svg")
			.attr("width", width)
			.attr("height", height);
			
		var group = canvas.append("g")
			.attr("transform","translate(300,300)");
			
		var arc = d3.svg.arc()
			.innerRadius(0)
			.outerRadius(r);
			
		var pie = d3.layout.pie()
			.value(function (d) { return d});
			
		var arcs = group.selectAll(".arc")
			.data(pie(data))
			.enter()
			.append("g")
			.attr("class","arc");
			
		arcs.append("path")
			.attr("d",arc)
			.attr("fill", function (d) { return color(d.data); });
			
		arcs.append("text")
			.attr("text-anchor", "middle")
			.attr("x", function(d) {
				var a = d.startAngle + (d.endAngle - d.startAngle)/2 - Math.PI/2;
				d.cx = Math.cos(a) * (r - 45);
				return d.x = Math.cos(a) * (r+30);
			})
			.attr("y", function(d) {
				var a = d.startAngle + (d.endAngle - d.startAngle)/2 - Math.PI/2;
				d.cy = Math.sin(a) * (r - 45);
				return d.y = Math.sin(a) * (r + 30);
			})
			.text(function(d) { return d.value;  })
			.each(function(d) {
				var bbox = this.getBBox();
				d.sx = d.x - bbox.width/2 - 2;
				d.ox = d.x + bbox.width/2 + 2;
				d.sy = d.oy = d.y + 5;
			});
			
		arcs.append("path")
			.attr("class", "pointer")
			.style("fill", "none")
			.style("stroke", "black")
    
			.attr("d", function(d) {
				console.log(d);
				if(d.cx > d.ox) {
					return "M" + d.sx + "," + d.sy + "L" + d.ox + "," + d.oy + " " + d.cx + "," + d.cy;
				} else {
					return "M" + d.ox + "," + d.oy + "L" + d.sx + "," + d.sy + " " + d.cx + "," + d.cy;
				}
		});
						
					
	</script>

</body>

</html>